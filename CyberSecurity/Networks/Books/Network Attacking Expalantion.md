# Ch. 1

**ا هلا بيك!** في الفصل ده هنتكلم عن أساسيات الشبكات، وهنفهم مع بعض إزاي الحاجات دي بتشتغل علشان نقدر نكمل مع بعض في تحليل بروتوكولات الشبكة واستغلال نقاط الضعف فيها.

**إيه هي الشبكة؟**  
ببساطة، الشبكة هي مجموعة من جهازين كمبيوتر أو أكتر متوصلين ببعض علشان يتبادلوا المعلومات. وكل جهاز في الشبكة بنسميه **عقدة (node)**.

**بروتوكول الشبكة**  
ده زي مجموعة قواعد كده لازم كل عقدة في الشبكة تفهمها علشان تعرف تتكلم مع باقي العقدات. البروتوكول ده مسؤول عن حاجات كتير زي:

- **الحفاظ على حالة الجلسة:** يعني إزاي تفتح اتصال جديد وتقفله لما تخلص.
    
- **تحديد العقد من خلال العنونة:** كل عقدة ليها عنوان فريد، وده بيضمن وصول البيانات للعقدة الصح.
    
- **التحكم في التدفق:** كمية البيانات اللي بتتنقل في الشبكة ليها حدود، فالبروتوكول بيدير تدفق البيانات علشان يزود السرعة ويقلل التأخير.
    
- **ترتيب البيانات المرسلة:** الشبكة مش دايما بتضمن وصول البيانات بنفس الترتيب اللي اتبعتت بيه، فالبروتوكول بيرتب البيانات علشان توصل صح.
    
- **اكتشاف وتصحيح الأخطاء:** ممكن البيانات تتلف أثناء النقل، فالبروتوكول بيكتشف الأخطاء ويصلحها.
    
- **تنسيق البيانات:** البيانات مش دايما بتكون في صورة مناسبة للنقل على الشبكة، فالبروتوكول بينسق البيانات علشان تتنقل صح.
    

**مجموعة بروتوكولات الإنترنت (Internet Protocol Suite - IPS)**  
دي مجموعة بروتوكولات بتستخدمها معظم الشبكات الحديثة، وأشهرها TCP/IP. مجموعة البروتوكولات دي بتقسم عملية نقل البيانات على الإنترنت لـ 4 طبقات:

- **طبقة الربط (Link Layer):** دي الطبقة الأساسية اللي بتوصف إزاي البيانات بتتنقل بين العقد على نفس الشبكة المحلية، زي الإيثرنت (Ethernet) والكابلات.
    
- **طبقة الإنترنت (Internet Layer):** الطبقة دي مسؤولة عن عنونة العقد على الشبكة، ومش لازم تكون العقد دي على نفس الشبكة المحلية. أشهر بروتوكول في الطبقة دي هو بروتوكول الإنترنت (IP) بنسختيه IPv4 و IPv6.
    
- **طبقة النقل (Transport Layer):** الطبقة دي مسؤولة عن الاتصال بين العملاء والخوادم، وبتضمن كمان ترتيب الباكيتات وتوفير خدمة تعدد الإرسال (multiplexing) اللي بتخلي عقدة واحدة تدعم خدمات كتير مختلفة. أشهر بروتوكولين في الطبقة دي هما TCP و UDP.
    
- **طبقة التطبيق (Application Layer):** الطبقة دي بتحتوي على بروتوكولات زي HTTP اللي بينقل صفحات الويب، و SMTP اللي بينقل الإيميلات، و DNS اللي بيحول اسم الموقع لعنوان IP.
    

**التغليف (Encapsulation)**  
كل طبقة في مجموعة بروتوكولات الإنترنت بتغلف البيانات اللي جاية من الطبقة اللي فوقيها علشان تتنقل بين الطبقات المختلفة. وحدة بيانات البروتوكول (Protocol Data Unit - PDU) دي بتحتوي على البيانات نفسها بالإضافة لـ:

- **رأس (Header):** ده بيحتوي على معلومات زي عنواني المصدر والوجهة.
    
- **تذييل (Footer):** ده بيحتوي على معلومات زي التحقق من الأخطاء.
    

**إرسال البيانات**  
لما جهاز عاوز يبعت بيانات لجهاز تاني على نفس الشبكة:

1. نظام التشغيل بيغلف البيانات ببروتوكول IP وبيحط عنواني المصدر والوجهة.
    
2. نظام التشغيل بيبعت طلب ARP لكل الأجهزة على الشبكة علشان يعرف عنوان MAC للجهاز اللي عاوز يبعتله البيانات.
    
3. لما يوصل الرد، نظام التشغيل بيغلف البيانات ببروتوكول Ethernet وبيحط عنواني المصدر والوجهة (MAC addresses).
    
4. البيانات بتتنقل عبر الشبكة لحد ما توصل للجهاز المقصود اللي بيفك التغليف ويطلع البيانات.
    

--- PAGE 339 ---  
**توجيه الشبكة (Network Routing)**  
ده بيحصل لما جهاز عاوز يبعت بيانات لجهاز تاني على شبكة مختلفة. البيانات بتتنقل بين أجهزة توجيه (Routers) لحد ما توصل للشبكة المقصودة.

**نموذج لتحليل بروتوكولات الشبكة**  
علشان نفهم و نحلل بروتوكولات الشبكة بشكل أسهل، بنقسمها لـ 3 طبقات:

- **طبقة المحتوى:** دي بتعبر عن معنى البيانات اللي بتتنقل.
    
- **طبقة التشفير:** دي بتحدد إزاي البيانات بتكون متمثلة.
    
- **طبقة النقل:** دي بتحدد إزاي البيانات بتتنقل بين الأجهزة.
    

**كده يبقى خلصنا الفصل الأول واتعرفنا على أساسيات الشبكات. في الفصول الجاية هنستخدم المعلومات دي علشان نتعلم إزاي نلتقط ونحلل ونستغل نقاط الضعف في بروتوكولات الشبكة.**

# Ch. 2
**e Capture)** و **الالتقاط النشط (Active Capture)**.

**الالتقاط السلبي**  
ده معناه إننا بنراقب حركة مرور البيانات من غير ما نتدخل فيها. زي لما بنستخدم أداة زي **Wireshark** علشان نشوف الباكيتات اللي بتتنقل على الشبكة. الطريقة دي ليها مميزات وعيوب:

**المميزات:**

- **سهلة ومش محتاجة مجهود كبير.**
    
- **مش بتأثر على التطبيقات اللي بتراقبها.**
    

**العيوب:**

- **ممكن يكون صعب تفهم البيانات اللي بتشوفها، خصوصا لو البروتوكول مش معروف.**
    
- **صعب تعدل على البيانات اللي بتتنقل.**
    

**أدوات الالتقاط السلبي:**

- **Wireshark:** دي أشهر أداة لالتقاط وتحليل الباكيتات، وبتدعم بروتوكولات كتير وسهلة الاستخدام.
    
- **تتبع استدعاءات النظام (System Call Tracing):**
    
    - **strace (Linux):** بتخليك تراقب استدعاءات النظام اللي بيستخدمها البرنامج، وده بيفيدك تعرف إزاي بيتعامل مع الشبكة.
        
    - **DTrace (macOS, Solaris, FreeBSD):** أداة قوية بتخليك تراقب حاجات كتير في النظام، زي استدعاءات النظام.
        
    - **Process Monitor (Windows):** بتخليك تراقب أحداث الشبكة اللي بيستخدمها البرنامج.
        

**الالتقاط النشط**  
ده معناه إننا بنتدخل في حركة مرور البيانات، عادةً عن طريق **هجوم الرجل في المنتصف (Man-in-the-Middle Attack)**، يعني بنخلي البيانات تمر عبر جهازنا قبل ما توصل للطرف التاني. الطريقة دي ليها مميزات وعيوب:

**المميزات:**

- **بتخليك تعدل على البيانات وتشوف إزاي التطبيقات هتتفاعل مع التعديلات.**
    
- **ممكن تستخدمها علشان تفك تشفير البيانات أو تلغي ضغطها.**
    

**العيوب:**

- **محتاجة مجهود أكبر في الإعداد.**
    
- **ممكن تأثر على التطبيقات اللي بتراقبها.**
    

--- PAGE 340 ---  
**وكلاء الشبكة (Network Proxies)**  
دي أشهر طريقة لعمل هجوم الرجل في المنتصف. الوكيل ده بيعمل زي جسر كده بين العميل والخادم، وبيخلي البيانات تمر عبره. في أنواع كتير من الوكلاء:

- **وكيل إعادة توجيه المنفذ (Port Forwarding Proxy):** ده أبسط نوع، وبيعمل إعادة توجيه للاتصال من منفذ على جهازك لمنفذ على الخادم.
    
- **وكيل SOCKS:** ده شبه وكيل إعادة التوجيه، بس بيدعم مميزات أكتر زي تحديد الوجهة من خلال اسم النطاق ودعم بروتوكول UDP.
    
- **وكيل HTTP:** ده بيستخدم لبروتوكول HTTP وHTTPS، وبيخليك تراقب وتعدل على حركة مرور الويب. فيه نوعين:
    
    - **وكيل HTTP المُوجِّه (Forwarding):** ده بيستخدم لالتقاط حركة مرور الويب اللي طالعة من جهازك.
        
    - **وكيل HTTP العكسي (Reverse):** ده بيستخدم لالتقاط حركة مرور الويب اللي جاية لجهازك.
        

**إزاي تختار طريقة الالتقاط؟**  
الطريقة اللي هتستخدمها بتعتمد على التطبيق اللي بتحلله. لو عاوز تراقب حركة مرور البيانات بس من غير ما تتدخل فيها، يبقى الالتقاط السلبي هو المناسب. لكن لو عاوز تتدخل وتعدل على البيانات، يبقى الالتقاط النشط هو اللي هتستخدمه. ولو التطبيق بيدعم وكيل SOCKS، يبقى دي أسهل طريقة لالتقاط حركة مرور البيانات.

**كده يبقى خلصنا الفصل الثاني واتعلمنا إزاي نلتقط حركة مرور البيانات. في الفصول الجاية هنستخدم المعلومات دي علشان نبدأ نحلل البروتوكولات ونكتشف نقاط الضعف فيها.**

# Ch. 3
**السلام عليكم!** في الفصل ده هنتكلم عن الهياكل الأساسية اللي بتستخدمها بروتوكولات الشبكة، سواء كانت نصية أو ثنائية، علشان تمثل البيانات المختلفة زي الأرقام والنصوص. لو فهمنا الهياكل دي، هيكون سهل علينا نحلل أي بروتوكول جديد ونفهم إزاي بيشتغل.

**هياكل البروتوكولات الثنائية**  
دي البروتوكولات اللي بتتعامل مع البيانات على مستوى البتات (bits). أصغر وحدة بيانات في البروتوكولات دي هي البايت (byte) اللي بيساوي 8 بتات. تعالوا نشوف إزاي البروتوكولات دي بتستخدم البايتات علشان تمثل أنواع مختلفة من البيانات:

- **البيانات الرقمية:**
    
    - **الأعداد الصحيحة بدون إشارة (Unsigned Integers):** دي أبسط طريقة لتمثيل الأرقام، وكل بت بيمثل قيمة معينة، وبتتجمع القيم دي علشان تمثل الرقم.
        
    - **الأعداد الصحيحة بإشارة (Signed Integers):** دي بتستخدم لتمثيل الأرقام السالبة والموجبة، وبتستخدم طريقة اسمها "تكملة الاثنين (Two's Complement)" علشان تمثل الرقم في صورة ثنائية.
        
    - **الأعداد الصحيحة ذات الطول المتغير (Variable-Length Integers):** دي بتستخدم لتوفير المساحة، وبتكون كل بايت بيمثل جزء من الرقم، والبت الأول بيمثل هل في بايت تاني ولا لأ.
        
    - **أرقام الفاصلة العائمة (Floating-Point Numbers):** دي بتستخدم لتمثيل الأرقام العشرية، وبتستخدم صيغة IEEE 754 اللي بتقسم الرقم لجزء صحيح وجزء كسري وأساس.
        
- **القيم المنطقية (Booleans):**  
    دي بتستخدم لتمثيل قيمتين بس: صح (True) وغلط (False). ممكن نستخدم بت واحد بس، أو بايت كامل علشان نمثلها.
    
- **أعلام البت (Bit Flags):** دي مجموعة بتات، كل بت بيمثل حالة معينة، زي أعلام TCP اللي بتحدد حالة الاتصال.
    
- **ترتيب البايتات (Endianness):** ده بيحدد ترتيب البايتات في الذاكرة لما بنخزن رقم كبير، زي عدد صحيح 32 بت. فيه نوعين:
    
    - **ترتيب كبير (Big Endian):** البايت الأكبر بيتخزن في العنوان الأصغر.
        
    - **ترتيب صغير (Little Endian):** البايت الأصغر بيتخزن في العنوان الأصغر.
        
- **النصوص والبيانات المقروءة:**
    
    - **ASCII:** دي مجموعة أحرف بتستخدم 7 بتات لتمثيل الحروف والأرقام والرموز الإنجليزية.
        
    - **صفحات الرموز (Code Pages):** دي بتستخدم علشان تدعم لغات أكتر غير الإنجليزي، وكل صفحة بتحدد مجموعة أحرف معينة.
        
    - **مجموعة الأحرف متعددة البايتات (Multibyte Character Sets):** دي بتستخدم للغات زي الصيني والياباني والكوري اللي محتاجة أكتر من 256 حرف.
        
    - **Unicode:** دي مجموعة أحرف بتحاول تدعم كل لغات العالم، وكل حرف ليه رقم فريد (Code Point). فيه طرق كتير لترميز Unicode، زي UTF-8 و UTF-16 و UTF-32.
        
- **البيانات ذات الطول المتغير:**
    
    - **البيانات المنتهية (Terminated Data):** دي بتستخدم رمز معين في نهاية البيانات علشان تحدد نهايتها، زي البايت NUL (قيمة 0) اللي بيستخدم لإنهاء النصوص في C.
        
    - **البيانات ذات البادئة الطول (Length-Prefixed Data):** دي بتستخدم قيمة في بداية البيانات علشان تحدد طولها.
        
    - **البيانات ذات الطول الضمني (Implicit-Length Data):** دي بيكون طولها واضح من سياق البيانات، زي لما السيرفر يقفل الاتصال علشان يحدد نهاية البيانات.
        
    - **البيانات المبطنة (Padded Data):** دي بتستخدم قيمة معينة علشان تملأ المساحة الفاضية في الباكيت لحد ما يوصل لطول معين.
        

--- PAGE 341 ---

- **التواريخ والأوقات:**
    
    - **وقت POSIX/Unix:** ده بيمثل عدد الثواني اللي عدت من بداية 1 يناير 1970.
        
    - **FILETIME (Windows):** ده بيمثل عدد الوحدات الزمنية اللي عدت من بداية 1 يناير 1601، وكل وحدة بتمثل 100 نانوثانية.
        
- **نمط العلامة، الطول، القيمة (Tag, Length, Value - TLV):** ده نمط شائع لتمثيل البيانات، وكل قيمة بتكون مسبوقة بعلامة بتحدد نوعها وطولها.
    
- **تعدد الإرسال والتجزئة:**
    
    - **تعدد الإرسال (Multiplexing):** ده بيستخدم علشان ندمج أكتر من قناة بيانات في اتصال واحد، وده بيفيد لما يكون عندنا أنواع كتير من البيانات اللي بتتنقل في نفس الوقت.
        
    - **التجزئة (Fragmentation):** ده بيستخدم علشان نقسم البيانات لباكيتات أصغر لو كانت كبيرة على الشبكة اللي بنستخدمها.
        
- **معلومات عنوان الشبكة:** دي بتكون عادةً عنوان IP (4 أو 16 بايت) والمنفذ (2 بايت).
    
- **الصيغ الثنائية المُهيكلة:**
    
    - **ASN.1:** دي صيغة بتستخدم لتمثيل البيانات المُهيكلة، وبتستخدم في بروتوكولات زي SNMP و X.509.
        

**هياكل البروتوكولات النصية**  
دي البروتوكولات اللي بتستخدم النصوص لتمثيل البيانات. تعالوا نشوف إزاي بتتعامل مع الأنواع المختلفة من البيانات:

- **البيانات الرقمية:** بتستخدم نفس طريقة تمثيل الأرقام في النصوص العادية، زي الأرقام العربية أو اللاتينية.
    
- **القيم المنطقية:** بتستخدم الكلمات "صح" و"غلط" أو "True" و"False" لتمثيل القيم المنطقية.
    
- **التواريخ والأوقات:** بتستخدم صيغ مختلفة لتمثيل التواريخ والأوقات، زي الصيغة العالمية ISO 8601.
    
- **البيانات ذات الطول المتغير:**
    
    - **النصوص المحددة (Delimited Text):** دي بتستخدم رموز معينة لفصل القيم عن بعضها، زي المسافة أو الفاصلة.
        
    - **النصوص المنتهية (Terminated Text):** دي بتستخدم رمز معين لإنهاء السطر، زي CR LF في HTTP.
        
- **الصيغ النصية المُهيكلة:**
    
    - **MIME:** دي بتستخدم لترميز مرفقات الإيميل وصفحات الويب، وبتقسم البيانات لأجزاء وبتستخدم رأس (header) لكل جزء علشان تحدد نوعه.
        
    - **JSON:** دي صيغة بسيطة لتمثيل البيانات المُهيكلة، وبتستخدم في تطبيقات الويب وخدمات الويب.
        
    - **XML:** دي لغة ترميز بتستخدم لوصف البيانات المُهيكلة، وبتستخدم في تطبيقات كتير زي RSS و XMPP.
        
- **ترميز البيانات الثنائية:**
    
    - **ترميز سداسي عشري (Hex Encoding):** ده بيحول كل بايت لرمزين سداسي عشري.
        
    - **ترميز Base64:** ده بيحول كل 3 بايتات لـ 4 رموز من مجموعة 64 رمز.
# TAG
#books